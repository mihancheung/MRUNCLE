<import src="/tpls/loading/loading.wxml" />

<wxs module="msgWxs">
  var getQouteReplyToTxt = function (replyTo) {
    return replyTo ? ' å›žå¾© @' + replyTo : '';
  }

  module.exports = {
    getQouteReplyToTxt: getQouteReplyToTxt
  }
</wxs>

<view class="replies" capture-bind:touchmove="onTouchMoveBox">
  <block wx:for="{{list}}" wx:for-item="listItem" wx:for-index="listIndex" wx:key="listIndex">
    <movable-area wx:if="{{item}}" class="replies_item_movable_area" wx:for="{{listItem}}" wx:key="_id">
      <movable-view bindchange="onTouchMoveBox" direction="horizontal" x="{{item.x}}" damping="{{50}}" inertia class="replies_item_movable_view" data-index="{{[listIndex, index]}}" bind:touchstart="onTouchStart" bind:touchend="onTouchEnd">
        <view class="replies_item" bind:tap="onTapReply"  data-index="{{[listIndex, index]}}" data-comment-id="{{item.commentId}}">
          <image class="replies_item_avata" src="{{item.replier.avatarUrl}}" />
          <text class="replies_item_comment">{{item.cnt}}</text>
          <view class="replies_item_main">
            <view class="replies_item_title"><text class="replies_item_replier">{{item.replier.nickName}}</text>å›žå¾©äº†æˆ‘<view wx:if="{{item.postTitle}}" class="replies_item_post_title">åœ¨<view bind:tap="onTapArticle" data-post-id="{{item.postId}}">ã€Š{{item.postTitle}}ã€‹</view></view>çš„è©•è«–</view>
            <view class="replies_item_cnt">
              <view class="replies_item_cnt_replyto" wx:if="{{item.replyToReply}}">å›žå¾©<text class="replies_item_cnt_replyto_name">@{{item.replyToReply.nickName}}</text>ï¼š</view>
              <view class="replies_item_cnt_text">{{item.replier.cnt}}</view>
            </view>
            <view class="replies_item_qoute" wx:if="{{item.replyToReply}}">
              {{item.replyToReply.nickName}}{{msgWxs.getQouteReplyToTxt(item.replyToReply.replyTo)}}ï¼š{{item.replyToReply.cnt}}
            </view>
            <text class="replies_item_date">{{item.date}}</text>
          </view>
        </view>
        <view class="replies_delete" bind:tap="onDelete" data-index="{{[listIndex, index]}}" data-id="{{item._id}}">åˆ é™¤</view>
      </movable-view>
    </movable-area>
  </block>

  <template is="loading" data="{{ isLoading, loadingText: 'æ’ˆç·Šå–‡å¤§ä½¬ðŸ¤¦ðŸ»â€â™‚ï¸', isNoShowImage: true }}" />
</view>

<view class="page_user_empty" wx:if="{{isShowEmpty}}">
  <image class="page_user_empty_icon" src="./images/comment_empty.svg" mode="heightFix" />
  <text class="page_user_empty_txt">ä»²æœªæ”¶åˆ°ä»»ä½•è©•è«–</text>
</view>